<!DOCTYPE html>
<html>
	<head>
		<title>Canvas Playground</title>
		<style type="text/css">
			body {
				margin: 0;
			}
			canvas {
				background-color: #22313F;
			}
			img {
				display: none;
			}
		</style>
	</head>
	<body>
		
		<canvas></canvas>
		<script
			src="https://code.jquery.com/jquery-3.2.1.js"
			integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
			crossorigin="anonymous">
		</script>
		<script>
		$(document).ready(function() {

			var canvas = document.querySelector("canvas");
			var gravity = 0.1;
			var friction = 0.2;
			var c = canvas.getContext("2d");
			var remove = false;
			var colors = [
			'#779c48',
			'#90c151',
			'#8bef98',
			'#bde589'
			];
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;
			window.addEventListener("resize", function() {
				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;
							
			});

			function randomIntFromRange(min,max) {
				return Math.floor(Math.random() * (max - min + 1) + min);
			}

			function randomColor(colors) {
				return colors[Math.floor(Math.random() * colors.length)];
			}
			//Constructor
			function Circle(x, y, dx, dy, radius, color, out, counter, flag) {
				this.x = x;
				this.y = y;
				this.dx = dx;
				this.dy = dy;
				this.radius = radius;
				this.color = color;
				this.out = out;
				this.counter = counter;
				this.flag = flag;
				//This Method determines a new position for the circle.
				this.update = function() {
					if (this.y + this.radius + this.dy > canvas.height) {
						this.dy = -this.dy;
						this.dy = this.dy * friction;
						this.dx = this.dx * friction;
					} else {
						this.dy += gravity;
					}

					if (this.x + this.radius >= canvas.width || this.x - this.radius <= 0) {
						this.dx = -this.dx * friction;
					}

					this.x += this.dx;
					this.y += this.dy;
					this.draw();
				};

				//This Method draws the circle on the canvas
				this.draw = function() {
					c.beginPath();
					c.arc(this.x, this.y, this.radius, 0, Math.PI * 2, false);  
					c.fillStyle = this.color;
					c.fill();
					c.shadowBlur=80;
					c.strokeStyle = "#779c48";
					c.shadowColor="#779c48";
					c.stroke();
					c.closePath();
					c.fillStyle='#779c48';
				}
			}

			//Init Function, this gives each circle it's starting value
			var circleArray = [];
			function init() {
				var radius = randomIntFromRange(5, 25);
				var x = randomIntFromRange(0, innerWidth);
				var y = randomIntFromRange(0 , innerHeight);
				var dx = randomIntFromRange(-2, 2);
				var dy = randomIntFromRange(-2, 2);
				var counter = 0;
				var flag = 0;
				var out = false;
				while(dx <= 0 && dx >= 0){
					dx = randomIntFromRange(-2, 2);
				}
				while(dy <= 0 && dy >= 0){ 
				 	dy = randomIntFromRange(-2, 2);
				}
				circleArray.push(new Circle(x, y, dx, dy, radius, randomColor(colors), remove));

			}
			//Function to request an animation frame and to lear the canvas
			function animate() {

				requestAnimationFrame(animate);
				c.clearRect(0, 0, innerWidth , innerHeight);

				for (var i = 0; i < circleArray.length; i++) {
					circleArray[i].update();
					if (remove) {
						circleArray.splice(i, 1);
						remove = false;
					}
				}
					if (circleArray.length < 15){
						for(var i = 0; i < 2; i++){
							init();  
						}
					}
			}
					
			animate();
		});
		</script>
	</body>
</html>